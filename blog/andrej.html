
<!DOCTYPE html>
<html>
<head>
    <link href="/images/favicon.ico" rel="icon" type="/image/x-icon" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="github.css">
</head>

<div class="navi"><div class="image-container"><a href="https://sberm.cn" class="link-wrapper"><img src="/images/leave.png" class="leave-img"/></a></div></div>
<div class = "spacing-div">
<article class="markdown-body">
<h1><a id="user-content-micrograd" class="anchor" aria-hidden="true" href="#micrograd"><span aria-hidden="true" class="octicon octicon-link"></span></a>micrograd</h1>
<p><a target="_blank" rel="noopener noreferrer" href="puppy.jpg"><img src="puppy.jpg" alt="awww" style="max-width: 100%;"></a></p>
<p>A tiny Autograd engine (with a bite! :)). Implements backpropagation (reverse-mode autodiff) over a dynamically built DAG and a small neural networks library on top of it with a PyTorch-like API. Both are tiny, with about 100 and 50 lines of code respectively. The DAG only operates over scalar values, so e.g. we chop up each neuron into all of its individual tiny adds and multiplies. However, this is enough to build up entire deep neural nets doing binary classification, as the demo notebook shows. Potentially useful for educational purposes.</p>
<h3><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h3>
<div class="highlight highlight-source-shell"><pre>pip install micrograd</pre></div>
<h3><a id="user-content-example-usage" class="anchor" aria-hidden="true" href="#example-usage"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example usage</h3>
<p>Below is a slightly contrived example showing a number of possible supported operations:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> <span class="pl-s1">micrograd</span>.<span class="pl-s1">engine</span> <span class="pl-k">import</span> <span class="pl-v">Value</span>

<span class="pl-s1">a</span> <span class="pl-c1">=</span> <span class="pl-v">Value</span>(<span class="pl-c1">-</span><span class="pl-c1">4.0</span>)
<span class="pl-s1">b</span> <span class="pl-c1">=</span> <span class="pl-v">Value</span>(<span class="pl-c1">2.0</span>)
<span class="pl-s1">c</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span> <span class="pl-c1">+</span> <span class="pl-s1">b</span>
<span class="pl-s1">d</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span> <span class="pl-c1">*</span> <span class="pl-s1">b</span> <span class="pl-c1">+</span> <span class="pl-s1">b</span><span class="pl-c1">**</span><span class="pl-c1">3</span>
<span class="pl-s1">c</span> <span class="pl-c1">+=</span> <span class="pl-s1">c</span> <span class="pl-c1">+</span> <span class="pl-c1">1</span>
<span class="pl-s1">c</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span> <span class="pl-c1">+</span> <span class="pl-s1">c</span> <span class="pl-c1">+</span> (<span class="pl-c1">-</span><span class="pl-s1">a</span>)
<span class="pl-s1">d</span> <span class="pl-c1">+=</span> <span class="pl-s1">d</span> <span class="pl-c1">*</span> <span class="pl-c1">2</span> <span class="pl-c1">+</span> (<span class="pl-s1">b</span> <span class="pl-c1">+</span> <span class="pl-s1">a</span>).<span class="pl-en">relu</span>()
<span class="pl-s1">d</span> <span class="pl-c1">+=</span> <span class="pl-c1">3</span> <span class="pl-c1">*</span> <span class="pl-s1">d</span> <span class="pl-c1">+</span> (<span class="pl-s1">b</span> <span class="pl-c1">-</span> <span class="pl-s1">a</span>).<span class="pl-en">relu</span>()
<span class="pl-s1">e</span> <span class="pl-c1">=</span> <span class="pl-s1">c</span> <span class="pl-c1">-</span> <span class="pl-s1">d</span>
<span class="pl-s1">f</span> <span class="pl-c1">=</span> <span class="pl-s1">e</span><span class="pl-c1">**</span><span class="pl-c1">2</span>
<span class="pl-s1">g</span> <span class="pl-c1">=</span> <span class="pl-s1">f</span> <span class="pl-c1">/</span> <span class="pl-c1">2.0</span>
<span class="pl-s1">g</span> <span class="pl-c1">+=</span> <span class="pl-c1">10.0</span> <span class="pl-c1">/</span> <span class="pl-s1">f</span>
<span class="pl-en">print</span>(<span class="pl-s">f'<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">g</span>.<span class="pl-s1">data</span>:.4f<span class="pl-kos">}</span></span>'</span>) <span class="pl-c"># prints 24.7041, the outcome of this forward pass</span>
<span class="pl-s1">g</span>.<span class="pl-en">backward</span>()
<span class="pl-en">print</span>(<span class="pl-s">f'<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">a</span>.<span class="pl-s1">grad</span>:.4f<span class="pl-kos">}</span></span>'</span>) <span class="pl-c"># prints 138.8338, i.e. the numerical value of dg/da</span>
<span class="pl-en">print</span>(<span class="pl-s">f'<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">b</span>.<span class="pl-s1">grad</span>:.4f<span class="pl-kos">}</span></span>'</span>) <span class="pl-c"># prints 645.5773, i.e. the numerical value of dg/db</span></pre></div>
<h3><a id="user-content-training-a-neural-net" class="anchor" aria-hidden="true" href="#training-a-neural-net"><span aria-hidden="true" class="octicon octicon-link"></span></a>Training a neural net</h3>
<p>The notebook <code>demo.ipynb</code> provides a full demo of training an 2-layer neural network (MLP) binary classifier. This is achieved by initializing a neural net from <code>micrograd.nn</code> module, implementing a simple svm "max-margin" binary classification loss and using SGD for optimization. As shown in the notebook, using a 2-layer neural net with two 16-node hidden layers we achieve the following decision boundary on the moon dataset:</p>
<p><a target="_blank" rel="noopener noreferrer" href="moon_mlp.png"><img src="moon_mlp.png" alt="2d neuron" style="max-width: 100%;"></a></p>
<h3><a id="user-content-tracing--visualization" class="anchor" aria-hidden="true" href="#tracing--visualization"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tracing / visualization</h3>
<p>For added convenience, the notebook <code>trace_graph.ipynb</code> produces graphviz visualizations. E.g. this one below is of a simple 2D neuron, arrived at by calling <code>draw_dot</code> on the code below, and it shows both the data (left number in each node) and the gradient (right number in each node).</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> <span class="pl-s1">micrograd</span> <span class="pl-k">import</span> <span class="pl-s1">nn</span>
<span class="pl-s1">n</span> <span class="pl-c1">=</span> <span class="pl-s1">nn</span>.<span class="pl-v">Neuron</span>(<span class="pl-c1">2</span>)
<span class="pl-s1">x</span> <span class="pl-c1">=</span> [<span class="pl-v">Value</span>(<span class="pl-c1">1.0</span>), <span class="pl-v">Value</span>(<span class="pl-c1">-</span><span class="pl-c1">2.0</span>)]
<span class="pl-s1">y</span> <span class="pl-c1">=</span> <span class="pl-en">n</span>(<span class="pl-s1">x</span>)
<span class="pl-s1">dot</span> <span class="pl-c1">=</span> <span class="pl-en">draw_dot</span>(<span class="pl-s1">y</span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="gout.svg"><img src="gout.svg" alt="2d neuron" style="max-width: 100%;"></a></p>
<h3><a id="user-content-running-tests" class="anchor" aria-hidden="true" href="#running-tests"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running tests</h3>
<p>To run the unit tests you will have to install <a href="https://pytorch.org/" rel="nofollow">PyTorch</a>, which the tests use as a reference for verifying the correctness of the calculated gradients. Then simply:</p>
<div class="highlight highlight-source-shell"><pre>python -m pytest</pre></div>
<h3><a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h3>
<p>MIT</p>
<h2><a id="user-content-ebpf也很好玩" class="anchor" aria-hidden="true" href="#ebpf也很好玩"><span aria-hidden="true" class="octicon octicon-link"></span></a>ebpf也很好玩</h2>
<h1><a id="user-content-getting-started-with-ebpf" class="anchor" aria-hidden="true" href="#getting-started-with-ebpf"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting started with eBPF</h1>
<p><strong>eBPF</strong> is the new standard to program Linux kernel capabilities in a safe and efficient manner without requiring to change kernel source code or loading kernel modules. It has enabled a new generation of high performance tooling to be developed covering networking, security, and observability use cases.</p>
<p>The best way to learn about eBPF is to read the book “What is eBPF” by Liz Rice. And the best way to have your first experience with eBPF programming is to walk through this lab, which takes the opensnoop example out of the book and teaches you to handle an eBPF tool, watch it loading its components and even add your own tracing into the source eBPF code.</p>

</article>

<div id="footer-main">
    <div id="footer-line">
    </div>
    <div id="footer-text-wrapper">
        <p id="footer-text">
            The steadfast love of the Lord never ceases; his mercies never come to an end; they are new every morning; great is your faithfulness.
        </p>
    </div>
    <div id="footer-commu-background">
        <div id="footer-commu">
            <div class="footer-image-container">
                <a href="https://www.youtube.com/watch?v=XqZsoesa55w">
                    <img class="footer-image" src="../images/linux.png"/>
                </a>
            </div>
            <div class="footer-image-container">
                <a href="https://twitter.com/Fernand73827208">
                    <img class="footer-image" src="../images/twitter.png"/>
                </a>
            </div>
            <div class="footer-image-container">
                <a href="https://github.com/torvalds">
                    <img class="footer-image" src="../images/github.svg"/>
                </a>
            </div>
        </div>
    </div>
</div>
<div>
</div>
</div>
</html>
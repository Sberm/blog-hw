
<!DOCTYPE html>
<html>
<head>
    <link href="/images/favicon.ico" rel="icon" type="/image/x-icon" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="github.css">
</head>

<div class="navi"><div class="image-container"><a href="https://sberm.cn" class="link-wrapper"><img src="/images/leave.png" class="leave-img"/></a></div></div>
<div class = "spacing-div">
<article class="markdown-body">
<h1><a id="user-content-python虚拟机也太耗内存了" class="anchor" aria-hidden="true" href="#python虚拟机也太耗内存了"><span aria-hidden="true" class="octicon octicon-link"></span></a>Python虚拟机也太耗内存了</h1>
<p>为了博客的正常运转我跑了四个python守护进程</p>
<div class="highlight highlight-source-shell"><pre>root        2064  0.0  1.1  65724 20056 <span class="pl-k">?</span>        S    Aug23   0:12 python3 -u scripts/update_html.py
root        2065  0.0  1.3 103028 23592 <span class="pl-k">?</span>        S    Aug23   0:12 python3 -u md/convert.py
root        2066  0.0  1.0  64372 18556 <span class="pl-k">?</span>        S    Aug23   0:15 python3 -u scripts/doc_html.py
root        2067  0.0  1.3 103192 23464 <span class="pl-k">?</span>        S    Aug23   0:21 python3 -u docs/md/convert_doc.py</pre></div>
<p>它们内存占用分别是<code>1.0 1.3 1.0 1.3</code> (百分比)</p>
<p>我的服务器内存有1.7GiB, 换算下来1.8GB左右</p>
<div class="highlight highlight-source-shell"><pre>              total        used        free      shared  buff/cache   available
Mem:          1.7Gi       593Mi       392Mi       2.0Mi       727Mi       971Mi
Swap:            0B          0B          0B</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="/images/Snipaste_2023-08-24_16-51-53.png"><img src="/images/Snipaste_2023-08-24_16-51-53.png" alt="" style="max-width: 100%;"></a></p>
<p>也就是说单个python进程内存占用18MB左右，这也太大了。这些进程都非常轻量，所以内存占用基本都是虚拟机造成的. 单个python3.9虚拟机 = 18MB内存，这也太恐怖了. 对照一下，nginx单个worker的内存占用最多只有0.7% (12.6MB) 不到</p>
<div class="highlight highlight-source-shell"><pre>root        1885  0.0  0.1 122456  2284 <span class="pl-k">?</span>        Ss   Aug23   0:00 nginx: master process nginx
root        1886  0.0  0.7 153916 12576 <span class="pl-k">?</span>        S    Aug23   0:00 nginx: worker process
root        1887  0.0  0.6 153692 11732 <span class="pl-k">?</span>        S    Aug23   0:00 nginx: worker process
root       30148  0.0  0.0  12136  1076 pts/10   R+   16:55   0:00 grep --color=auto nginx</pre></div>
<p>python果然不够轻量，以后写汇编了</p>

</article>

<div id="footer-main">
    <div id="footer-line">
    </div>
    <div id="footer-text-wrapper">
        <p id="footer-text">
            The steadfast love of the Lord never ceases; his mercies never come to an end; they are new every morning; great is your faithfulness.
        </p>
    </div>
    <div id="footer-commu-background">
        <div id="footer-commu">
            <div class="footer-image-container">
                <a href="https://www.youtube.com/watch?v=XqZsoesa55w">
                    <img class="footer-image" src="../images/linux.png"/>
                </a>
            </div>
            <div class="footer-image-container">
                <a href="https://twitter.com/Fernand73827208">
                    <img class="footer-image" src="../images/twitter.png"/>
                </a>
            </div>
            <div class="footer-image-container">
                <a href="https://github.com/torvalds">
                    <img class="footer-image" src="../images/github.svg"/>
                </a>
            </div>
        </div>
    </div>
</div>
<div>
</div>
</div>
</html>
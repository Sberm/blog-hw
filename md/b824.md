# Python虚拟机也太耗内存了

为了博客的正常运转我跑了四个python守护进程

```bash
root        2064  0.0  1.1  65724 20056 ?        S    Aug23   0:12 python3 -u scripts/update_html.py
root        2065  0.0  1.3 103028 23592 ?        S    Aug23   0:12 python3 -u md/convert.py
root        2066  0.0  1.0  64372 18556 ?        S    Aug23   0:15 python3 -u scripts/doc_html.py
root        2067  0.0  1.3 103192 23464 ?        S    Aug23   0:21 python3 -u docs/md/convert_doc.py
```

它们内存占用分别是`1.0 1.3 1.0 1.3` (百分比)

我的服务器内存有1.7GiB, 换算下来1.8GB左右

```bash
              total        used        free      shared  buff/cache   available
Mem:          1.7Gi       593Mi       392Mi       2.0Mi       727Mi       971Mi
Swap:            0B          0B          0B
```

![](/images/Snipaste_2023-08-24_16-51-53.png)

也就是说单个python进程内存占用18MB左右，这也太大了。这些进程都非常轻量，所以内存占用基本都是虚拟机造成的. 单个python3.9虚拟机 = 18MB内存，这也太恐怖了. 对照一下，nginx单个worker的内存占用最多只有0.7% (12.6MB) 不到

```bash
root        1885  0.0  0.1 122456  2284 ?        Ss   Aug23   0:00 nginx: master process nginx
root        1886  0.0  0.7 153916 12576 ?        S    Aug23   0:00 nginx: worker process
root        1887  0.0  0.6 153692 11732 ?        S    Aug23   0:00 nginx: worker process
root       30148  0.0  0.0  12136  1076 pts/10   R+   16:55   0:00 grep --color=auto nginx
```

python果然不够轻量，再也不用了 :)
